<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Location Logger</title>
</head>
<body onload="loadHistory()">

<h2>Location Tracker - Hyderabad User</h2>

<button onclick="getLocation()">Get My Location</button>

<p id="location"></p>

<h3>Last 5 Locations</h3>
<ul id="history"></ul>

<script>

function getLocation() {
    navigator.geolocation.getCurrentPosition(success, error)
}

function success(position) {
    let lat = position.coords.latitude
    let long = position.coords.longitude

    document.getElementById("location").innerHTML =
        "Latitude: " + lat + " Longitude: " + long

    let history = JSON.parse(localStorage.getItem("locations")) || []

    history.push({latitude: lat, longitude: long})

    if(history.length > 5) {
        history.shift()
    }

    localStorage.setItem("locations", JSON.stringify(history))
    loadHistory()
}

function error(err) {
    if(err.code == 1) {
        alert("Permission Denied")
    } else if(err.code == 2) {
        alert("Location Unavailable")
    } else {
        alert("Timeout")
    }
}

function loadHistory() {
    let history = JSON.parse(localStorage.getItem("locations")) || []
    let list = document.getElementById("history")
    list.innerHTML = ""

    history.forEach(function(loc) {
        let li = document.createElement("li")
        li.innerHTML = loc.latitude + " , " + loc.longitude
        list.appendChild(li)
    })
}

</script>

</body>
</html>